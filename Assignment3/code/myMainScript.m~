%% Assignment 3, CT Imaging
%  CS736: Medical Image Computing, IIT Bombay (Spring 2019)
%  Dhruv Shah and Ansh Khurana
%%
% <Description>

warning('off', 'all');
clc; clear all; close all;
%% Question 1 
img = phantom(128);
% imshow(f);
%% Part (a)
% myIntegration is implemented in myImplementation.m
% The integration is the lower Darboux sum over the pixel values on a given
% line specifed by (t, \theta). The parameter \delta_s is configurable 
% and is chosen to be 1*pixel width.
% We have used bilinear

%% Part (b)
% Implementation of Radon transformation can be found in myRadonTrans.m
% 
% Instead of calling myIntegration over the different ranges of t and
% \theta, the computation has been vectorized.
% 

%% Part (c) 
% Computation of Radon transform for different parameters:

dt = 1;
dth = 1; 

ds1 = 0.5;
ds2 = 1;
ds3 = 3;

t_range = -90:dt:90;
theta_range =  0:dth:175;

Rf1 = myRadonTrans(img, t_range, theta_range, ds1);
iptsetpref('ImshowAxesVisible','on')

subplot(1,3, 1), imshow(Rf1, [],'Ydata', theta_range, 'Xdata', t_range, 'InitialMagnification','fit')
xlabel('\theta (degrees)')
ylabel('t')
title("Radon transform plot \Delta\theta = 1, \Deltat = 1, \Deltas = 0.5");
colormap(gca,hot), colorbar

Rf1 = myRadonTrans(img, t_range, theta_range, ds2);
iptsetpref('ImshowAxesVisible','on')

subplot(1,3, 2), imshow(Rf1, [],'Ydata', theta_range, 'Xdata', t_range, 'InitialMagnification','fit')
xlabel('\theta (degrees)')
ylabel('t')
title("Radon transform plot \Delta\theta = 1, \Deltat = 1, \Deltas = 1");
colormap(gca,hot), colorbar

figure;

Rf1 = myRadonTrans(img, t_range, theta_range, ds3);
iptsetpref('ImshowAxesVisible','on')

subplot(1,3,3), imshow(Rf1, [],'Ydata', theta_range, 'Xdata', t_range, 'InitialMagnification','fit')
xlabel('\theta (degrees)')
ylabel('t')
title("Radon transform plot \Delta\theta = 1, \Deltat = 1, \Deltas = 3");
colormap(gca,hot), colorbar

% Part b. 
